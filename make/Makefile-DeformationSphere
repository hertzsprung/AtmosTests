$(eval $(call HexGeodesicMesh,build/deformationSphere-mesh-hex-4,src/deformationSphere/mesh-4.obj))
$(eval $(call TriGeodesicMesh,build/deformationSphere-mesh-tri-4,build/deformationSphere-mesh-hex-4))

$(eval $(call HexGeodesicMesh,build/deformationSphere-mesh-hex-5,src/deformationSphere/mesh-5.obj))
$(eval $(call TriGeodesicMesh,build/deformationSphere-mesh-tri-5,build/deformationSphere-mesh-hex-5))

$(eval $(call HexGeodesicMesh,build/deformationSphere-mesh-hex-6,src/deformationSphere/mesh-6.obj))
$(eval $(call TriGeodesicMesh,build/deformationSphere-mesh-tri-6,build/deformationSphere-mesh-hex-6))

$(eval $(call HexGeodesicMesh,build/deformationSphere-mesh-hex-7,src/deformationSphere/mesh-7.obj))
$(eval $(call TriGeodesicMesh,build/deformationSphere-mesh-tri-7,build/deformationSphere-mesh-hex-7))

$(eval $(call HexGeodesicMesh,build/deformationSphere-mesh-hex-8,src/deformationSphere/mesh-8.obj))
$(eval $(call TriGeodesicMesh,build/deformationSphere-mesh-tri-8,build/deformationSphere-mesh-hex-8))

# $1 -- case
# $2 -- mesh
# $3 -- velocity case
# $4 -- timestep
# $5 -- advection scheme
define DeformationalAdvectionConvergenceTest

$(eval $(call DeformationalAdvection,$1,$2,$3,src/deformationSphere/geodesicGaussians,$5 src/advection/system/commonFvSchemes,$4))

endef

# $1 -- mesh suffix (e.g. hex-4)
# $2 -- timestep
define DeformationalAdvectionConvergenceTestSuite

$(eval $(call DeformationalAdvectionConvergenceTest,build/deformationSphere-gaussians-nondiv-linearUpwind-$1,build/deformationSphere-mesh-$1,build/deformationSphere-nondiv-$1-velocity,$2,src/advection/system/linearUpwind))
$(eval $(call DeformationalAdvectionConvergenceTest,build/deformationSphere-gaussians-nondiv-cubicUpwind-$1,build/deformationSphere-mesh-$1,build/deformationSphere-nondiv-$1-velocity,$2,src/advection/system/cubicUpwindCPCFit))

endef

# $1 -- mesh type (e.g. hex)
# $2 -- error filename
# $3 -- resolutions
define DeformationalAdvectionCollation

$(eval $(call CollateErrorsOnSphere,build/deformationSphere-gaussians-nondiv-linearUpwind-$1-,$2,$3))
$(eval $(call CollateErrorsOnSphere,build/deformationSphere-gaussians-nondiv-cubicUpwind-$1-,$2,$3))

endef

$(eval $(call DeformationalAdvectionConvergenceTestSuite,hex-4,6400))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,hex-5,3200))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,hex-6,1600))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,hex-7,800))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,hex-8,400))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,tri-4,3200))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,tri-5,1600))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,tri-6,800))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,tri-7,400))

$(eval $(call DeformationalAdvectionCollation,hex,$(deformationalAdvectionEndTime)/l2errorT.txt,4 5 6 7 8))
$(eval $(call DeformationalAdvectionCollation,hex,$(deformationalAdvectionEndTime)/linferrorT.txt,4 5 6 7 8))
$(eval $(call DeformationalAdvectionCollation,tri,$(deformationalAdvectionEndTime)/l2errorT.txt,4 5 6 7))
$(eval $(call DeformationalAdvectionCollation,tri,$(deformationalAdvectionEndTime)/linferrorT.txt,4 5 6 7))

$(eval $(call MakeDir,build/deformationSphere-gaussians-nondiv-linearUpwind-hex-collated/$(deformationalAdvectionEndTime)/))
$(eval $(call MakeDir,build/deformationSphere-gaussians-nondiv-cubicUpwind-hex-collated/$(deformationalAdvectionEndTime)/))
$(eval $(call MakeDir,build/deformationSphere-gaussians-nondiv-linearUpwind-tri-collated/$(deformationalAdvectionEndTime)/))
$(eval $(call MakeDir,build/deformationSphere-gaussians-nondiv-cubicUpwind-tri-collated/$(deformationalAdvectionEndTime)/))
