$(eval $(call HexGeodesicMesh,build/deformationSphere-mesh-hex-4,src/deformationSphere/mesh-4.obj))
$(eval $(call HexGeodesicMesh,build/deformationSphere-mesh-hex-5,src/deformationSphere/mesh-5.obj))
$(eval $(call HexGeodesicMesh,build/deformationSphere-mesh-hex-6,src/deformationSphere/mesh-6.obj))
$(eval $(call HexGeodesicMesh,build/deformationSphere-mesh-hex-7,src/deformationSphere/mesh-7.obj))
$(eval $(call HexGeodesicMesh,build/deformationSphere-mesh-hex-8,src/deformationSphere/mesh-8.obj))

$(eval $(call TriGeodesicMesh,build/deformationSphere-mesh-tri-4,build/deformationSphere-mesh-hex-4))
$(eval $(call TriGeodesicMesh,build/deformationSphere-mesh-tri-5,build/deformationSphere-mesh-hex-5))
$(eval $(call TriGeodesicMesh,build/deformationSphere-mesh-tri-6,build/deformationSphere-mesh-hex-6))
$(eval $(call TriGeodesicMesh,build/deformationSphere-mesh-tri-7,build/deformationSphere-mesh-hex-7))
$(eval $(call TriGeodesicMesh,build/deformationSphere-mesh-tri-8,build/deformationSphere-mesh-hex-8))

$(eval $(call QuadGeodesicMesh,build/deformationSphere-mesh-quad-15,15))
$(eval $(call QuadGeodesicMesh,build/deformationSphere-mesh-quad-30,30))
$(eval $(call QuadGeodesicMesh,build/deformationSphere-mesh-quad-60,60))
$(eval $(call QuadGeodesicMesh,build/deformationSphere-mesh-quad-120,120))
$(eval $(call QuadGeodesicMesh,build/deformationSphere-mesh-quad-240,240))

$(eval $(call LatLonGeodesicMesh,build/deformationSphere-mesh-latlon-36,src/deformationSphere/mesh-latlon-36))
$(eval $(call LatLonGeodesicMesh,build/deformationSphere-mesh-latlon-72,src/deformationSphere/mesh-latlon-72))
$(eval $(call LatLonGeodesicMesh,build/deformationSphere-mesh-latlon-144,src/deformationSphere/mesh-latlon-144))
$(eval $(call LatLonGeodesicMesh,build/deformationSphere-mesh-latlon-288,src/deformationSphere/mesh-latlon-288))

# $1 -- case
# $2 -- mesh
# $3 -- timestep
# $4 -- advection scheme
define DeformationalAdvectionDivergenceTest

$(eval $(call DeformationalAdvection,$1,$2,src/deformationSphere/divergent,src/deformationSphere/geodesicGaussians,$4 src/advection/system/commonFvSchemes,$3))

endef

$(eval $(call DeformationalAdvectionDivergenceTest,build/deformationSphere-cosBells-div-linearUpwind-hex-5,build/deformationSphere-mesh-hex-5,3200,src/advection/system/linearUpwind))
$(eval $(call DeformationalAdvectionDivergenceTest,build/deformationSphere-cosBells-div-cubicUpwind-hex-5,build/deformationSphere-mesh-hex-5,3200,src/advection/system/cubicUpwindCPCFit))


# $1 -- case
# $2 -- mesh
# $3 -- timestep
# $4 -- advection scheme
define DeformationalAdvectionConvergenceTest

$(eval $(call DeformationalAdvection,$1,$2,src/deformationSphere/nonDivergent,src/deformationSphere/geodesicGaussians,$4 src/advection/system/commonFvSchemes,$3))

endef

# $1 -- mesh suffix (e.g. hex-4)
# $2 -- timestep
define DeformationalAdvectionConvergenceTestSuite

$(eval $(call DeformationalAdvectionConvergenceTest,build/deformationSphere-gaussians-nondiv-linearUpwind-$1,build/deformationSphere-mesh-$1,$2,src/advection/system/linearUpwind))
$(eval $(call DeformationalAdvectionConvergenceTest,build/deformationSphere-gaussians-nondiv-cubicUpwind-$1,build/deformationSphere-mesh-$1,$2,src/advection/system/cubicUpwindCPCFit))

endef

# $1 -- mesh type (e.g. hex)
# $2 -- error filename
# $3 -- resolutions
define DeformationalAdvectionCollation

$(eval $(call CollateErrorsOnSphere,build/deformationSphere-gaussians-nondiv-linearUpwind-$1-,$2,$3))
$(eval $(call CollateErrorsOnSphere,build/deformationSphere-gaussians-nondiv-cubicUpwind-$1-,$2,$3))

endef

$(eval $(call DeformationalAdvectionConvergenceTestSuite,hex-4,6400))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,hex-5,3200))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,hex-6,1600))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,hex-7,800))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,hex-8,400))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,tri-4,3200))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,tri-5,1600))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,tri-6,800))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,tri-7,400))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,quad-15,1600))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,quad-30,800))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,quad-60,400))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,quad-120,200))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,quad-240,100))

$(eval $(call DeformationalAdvectionCollation,hex,$(deformationalAdvectionEndTime)/l2errorT.txt,4 5 6 7))
$(eval $(call DeformationalAdvectionCollation,hex,$(deformationalAdvectionEndTime)/linferrorT.txt,4 5 6 7))
$(eval $(call DeformationalAdvectionCollation,tri,$(deformationalAdvectionEndTime)/l2errorT.txt,4 5 6 7))
$(eval $(call DeformationalAdvectionCollation,tri,$(deformationalAdvectionEndTime)/linferrorT.txt,4 5 6 7))
$(eval $(call DeformationalAdvectionCollation,quad,$(deformationalAdvectionEndTime)/l2errorT.txt,15 30 60 120))
$(eval $(call DeformationalAdvectionCollation,quad,$(deformationalAdvectionEndTime)/linferrorT.txt,15 30 60 120))

$(eval $(call MakeDir,build/deformationSphere-gaussians-nondiv-linearUpwind-hex-collated/$(deformationalAdvectionEndTime)/))
$(eval $(call MakeDir,build/deformationSphere-gaussians-nondiv-cubicUpwind-hex-collated/$(deformationalAdvectionEndTime)/))
$(eval $(call MakeDir,build/deformationSphere-gaussians-nondiv-linearUpwind-tri-collated/$(deformationalAdvectionEndTime)/))
$(eval $(call MakeDir,build/deformationSphere-gaussians-nondiv-cubicUpwind-tri-collated/$(deformationalAdvectionEndTime)/))
$(eval $(call MakeDir,build/deformationSphere-gaussians-nondiv-linearUpwind-quad-collated/$(deformationalAdvectionEndTime)/))
$(eval $(call MakeDir,build/deformationSphere-gaussians-nondiv-cubicUpwind-quad-collated/$(deformationalAdvectionEndTime)/))
