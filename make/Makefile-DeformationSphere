$(eval $(call HexGeodesicMesh,build/deformationSphere-mesh-hex-2,src/deformationSphere/mesh-2.obj))
$(eval $(call HexGeodesicMesh,build/deformationSphere-mesh-hex-3,src/deformationSphere/mesh-3.obj))
$(eval $(call HexGeodesicMesh,build/deformationSphere-mesh-hex-4,src/deformationSphere/mesh-4.obj))
$(eval $(call HexGeodesicMesh,build/deformationSphere-mesh-hex-5,src/deformationSphere/mesh-5.obj))
$(eval $(call HexGeodesicMesh,build/deformationSphere-mesh-hex-6,src/deformationSphere/mesh-6.obj))
$(eval $(call HexGeodesicMesh,build/deformationSphere-mesh-hex-7,src/deformationSphere/mesh-7.obj))
$(eval $(call HexGeodesicMesh,build/deformationSphere-mesh-hex-8,src/deformationSphere/mesh-8.obj))
$(eval $(call HexGeodesicMesh,build/deformationSphere-mesh-hex-9,src/deformationSphere/mesh-9.obj))

$(eval $(call QuadGeodesicMesh,build/deformationSphere-mesh-quad-8,8))
$(eval $(call QuadGeodesicMesh,build/deformationSphere-mesh-quad-15,15))
$(eval $(call QuadGeodesicMesh,build/deformationSphere-mesh-quad-30,30))
$(eval $(call QuadGeodesicMesh,build/deformationSphere-mesh-quad-60,60))
$(eval $(call QuadGeodesicMesh,build/deformationSphere-mesh-quad-120,120))
$(eval $(call QuadGeodesicMesh,build/deformationSphere-mesh-quad-240,240))

# $1 -- case
# $2 -- mesh
# $3 -- timestep
# $4 -- advection scheme
define DeformationalAdvectionDivergenceTest

$(eval $(call DeformationalAdvection,$1,$2,src/deformationSphere/divergent,src/deformationSphere/cosBells,$4 src/advection/system/commonFvSchemes,$3))

endef

$(eval $(call DeformationalAdvectionDivergenceTest,build/deformationSphere-cosBells-div-linearUpwind-hex-5,build/deformationSphere-mesh-hex-5,3200,src/advection/system/linearUpwind))
$(eval $(call DeformationalAdvectionDivergenceTest,build/deformationSphere-cosBells-div-cubicUpwind-hex-5,build/deformationSphere-mesh-hex-5,3200,src/deformationSphere/system/cubicFit))
$(eval $(call DeformationalAdvectionDivergenceTest,build/deformationSphere-cosBells-div-linearUpwind-quad-15,build/deformationSphere-mesh-quad-15,1600,src/advection/system/linearUpwind))
$(eval $(call DeformationalAdvectionDivergenceTest,build/deformationSphere-cosBells-div-cubicUpwind-quad-15,build/deformationSphere-mesh-quad-15,1600,src/deformationSphere/system/cubicFit))


# $1 -- case
# $2 -- mesh
# $3 -- timestep
# $4 -- advection scheme
# $5 -- tracer profile
define DeformationalAdvectionConvergenceTest

$(eval $(call DeformationalAdvection,$1,$2,src/deformationSphere/nonDivergent,$5,$4 src/advection/system/commonFvSchemes,$3))

endef

# $1 -- mesh suffix (e.g. hex-4)
# $2 -- timestep
define DeformationalAdvectionConvergenceTestSuite

$(eval $(call DeformationalAdvectionConvergenceTest,build/deformationSphere-gaussians-nondiv-linearUpwind-$1,build/deformationSphere-mesh-$1,$2,src/advection/system/linearUpwind,src/deformationSphere/geodesicGaussians))
$(eval $(call DeformationalAdvectionConvergenceTest,build/deformationSphere-gaussians-nondiv-cubicUpwind-$1,build/deformationSphere-mesh-$1,$2,src/deformationSphere/system/cubicFit,src/deformationSphere/geodesicGaussians))

$(eval $(call DeformationalAdvectionConvergenceTest,build/deformationSphere-cosBells-nondiv-linearUpwind-$1,build/deformationSphere-mesh-$1,$2,src/advection/system/linearUpwind,src/deformationSphere/cosBells))
$(eval $(call DeformationalAdvectionConvergenceTest,build/deformationSphere-cosBells-nondiv-cubicUpwind-$1,build/deformationSphere-mesh-$1,$2,src/deformationSphere/system/cubicFit,src/deformationSphere/cosBells))

endef

# $1 -- mesh type (e.g. hex)
# $2 -- error filename
# $3 -- resolutions
define DeformationalAdvectionCollation

$(eval $(call CollateErrorsOnSphere,build/deformationSphere-gaussians-nondiv-linearUpwind-$1-,$2,$3))
$(eval $(call CollateErrorsOnSphere,build/deformationSphere-gaussians-nondiv-cubicUpwind-$1-,$2,$3))

$(eval $(call CollateErrorsOnSphere,build/deformationSphere-cosBells-nondiv-linearUpwind-$1-,$2,$3))
$(eval $(call CollateErrorsOnSphere,build/deformationSphere-cosBells-nondiv-cubicUpwind-$1-,$2,$3))

endef

$(eval $(call DeformationalAdvectionConvergenceTestSuite,hex-4,3200))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,hex-5,1600))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,hex-6,800))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,hex-7,400))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,hex-8,200))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,hex-9,100))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,quad-15,1000))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,quad-30,500))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,quad-60,250))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,quad-120,125))
$(eval $(call DeformationalAdvectionConvergenceTestSuite,quad-240,62.5))

$(eval $(call DeformationalAdvectionCollation,hex,$(deformationalAdvectionEndTime)/l2errorT.txt,4 5 6 7 8 9))
$(eval $(call DeformationalAdvectionCollation,hex,$(deformationalAdvectionEndTime)/linferrorT.txt,4 5 6 7 8 9))
$(eval $(call DeformationalAdvectionCollation,tri,$(deformationalAdvectionEndTime)/l2errorT.txt,4 5 6 7))
$(eval $(call DeformationalAdvectionCollation,tri,$(deformationalAdvectionEndTime)/linferrorT.txt,4 5 6 7))
$(eval $(call DeformationalAdvectionCollation,quad,$(deformationalAdvectionEndTime)/l2errorT.txt,15 30 60 120))
$(eval $(call DeformationalAdvectionCollation,quad,$(deformationalAdvectionEndTime)/linferrorT.txt,15 30 60 120))

$(eval $(call MakeDir,build/deformationSphere-gaussians-nondiv-linearUpwind-hex-collated/$(deformationalAdvectionEndTime)/))
$(eval $(call MakeDir,build/deformationSphere-gaussians-nondiv-cubicUpwind-hex-collated/$(deformationalAdvectionEndTime)/))
$(eval $(call MakeDir,build/deformationSphere-gaussians-nondiv-linearUpwind-quad-collated/$(deformationalAdvectionEndTime)/))
$(eval $(call MakeDir,build/deformationSphere-gaussians-nondiv-cubicUpwind-quad-collated/$(deformationalAdvectionEndTime)/))
$(eval $(call MakeDir,build/deformationSphere-cosBells-nondiv-linearUpwind-hex-collated/$(deformationalAdvectionEndTime)/))
$(eval $(call MakeDir,build/deformationSphere-cosBells-nondiv-cubicUpwind-hex-collated/$(deformationalAdvectionEndTime)/))
$(eval $(call MakeDir,build/deformationSphere-cosBells-nondiv-linearUpwind-quad-collated/$(deformationalAdvectionEndTime)/))
$(eval $(call MakeDir,build/deformationSphere-cosBells-nondiv-cubicUpwind-quad-collated/$(deformationalAdvectionEndTime)/))
