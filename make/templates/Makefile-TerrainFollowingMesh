# $1 -- case
# $2 -- noOrography mesh
# $3 -- add2dMountainDict
define TerrainFollowingMesh

$(eval $(call __TerrainFollowingMesh,$1,$2,$3,$(dummy)/$(controlDict)))

endef

# $1 -- case
# $2 -- noOrography mesh
# $3 -- add2dMountainDict
# $4 -- controlDict
define __TerrainFollowingMesh

.INTERMEDIATE: $1.intermediate

$(addprefix $1/,$(meshFiles)): $1.intermediate

$1.intermediate: \
  $1/$(add2dMountainDict) \
  $(addprefix $1/,$(systemFiles)) \
  $(addprefix $2/,$(meshFiles)) \
| $1/constant
	$(rsync) -ru -delete $2/$(polyMesh) $1/constant
	$(add2dMountain) -case $1

$(eval $(call CopyFile,$3,$1/$(add2dMountainDict)))
$(eval $(call CopyFile,$4,$1/$(controlDict)))
$(eval $(call CopyNamedFiles,$(dummy),$(fvSchemes) $(fvSolution),$1))
$(eval $(call MakeDir,$1/constant))
$(eval $(call MakeDir,$1/system))

endef
