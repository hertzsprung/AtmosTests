sk94NonHydroWavesEndTime := 3000

# $1 -- case
# $2 -- mesh
define sk94NonHydroWavesLorenz

$(eval $(call sk94NonHydroWaves,$1,$2,$(exnerFoamH),InitialExnerInterpTheta))

$(eval $(call FieldDiff,$1,0,theta,$1-backgroundTheta/0/theta))
$(eval $(call FieldDiff,$1,$(sk94NonHydroWavesEndTime),theta,$1-backgroundTheta/0/theta))

endef

# $1 -- case
# $2 -- mesh
define sk94NonHydroWavesCharneyPhillips

$(eval $(call sk94NonHydroWaves,$1,$2,$(exnerFoamCP),InitialExnerNoInterpTheta))

$(eval $(call FieldDiff,$1-theta,0,computedTheta,$1-backgroundTheta/0/computedTheta))
$(eval $(call FieldDiff,$1-theta,0,computedThetaf,$1-backgroundTheta/0/computedThetaf))
$(eval $(call FieldDiff,$1,$(sk94NonHydroWavesEndTime),theta,$1-backgroundTheta/0/computedTheta))
$(eval $(call FieldDiff,$1,$(sk94NonHydroWavesEndTime),thetaf,$1-backgroundTheta/0/computedThetaf))
$(eval $(call ComputeTheta,$1-backgroundTheta))
$(eval $(call ComputeTheta,$1-theta))
$(eval $(call CopyFile,src/sk94NonHydroWaves/$(environmentalProperties),$1-theta/$(environmentalProperties)))

endef

# $1 -- case
# $2 -- mesh
# $3 -- solver
# $4 -- InitialExner template
define sk94NonHydroWaves

$(eval $(call MakeDir,$1/$(sk94NonHydroWavesEndTime)))

$(eval $(call Physical,$1,$2,src/sk94NonHydroWaves/0/Uf,$1-theta/0/theta,$1-exner/0/Exner,src/sk94NonHydroWaves/$(environmentalProperties),src/physical/$(thermophysicalProperties),src/sk94NonHydroWaves/$(fvSchemes),src/sk94NonHydroWaves/$(fvSolution),$(sk94NonHydroWavesEndTime),12,3000,$3))
$(eval $(call PerturbTheta,$1-theta,$2,$1-backgroundTheta/0/theta,src/sk94NonHydroWaves/constant/perturbFieldDict))
$(eval $(call InitialTheta,$1-backgroundTheta,$2,src/sk94NonHydroWaves/$(thetaInit),src/sk94NonHydroWaves/$(environmentalProperties),src/physical/$(thermophysicalProperties),src/sk94NonHydroWaves/$(fvSchemes),src/sk94NonHydroWaves/$(fvSolution),src/sk94NonHydroWaves/$(thetafInit)))
$(eval $(call $4,$1-exner,$2,src/sk94NonHydroWaves/$(exnerInit),$1-theta/0/theta,src/sk94NonHydroWaves/$(environmentalProperties),src/physical/$(thermophysicalProperties),src/sk94NonHydroWaves/$(fvSchemes),src/sk94NonHydroWaves/$(fvSolution)))

endef


