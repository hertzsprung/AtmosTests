# $1 -- case
# $2 -- mesh
# $3 -- velocityFieldDict
# $4 -- timestep
# $5 -- advection scheme
define SolidBodyAdvectionTest

$(eval $(call SolidBodyAdvection,$1,$2,$3,src/deformationSphere/geodesicGaussians,$5,$4))

endef


# $1 -- mesh suffix (e.g. hex-4)
# $2 -- timestep
define SolidBodyAdvectionTestSuite

$(eval $(call SolidBodyAdvectionTest,build/solidBodySphere-noTilt-linearUpwind-$1,build/deformationSphere-mesh-$1,src/solidBodySphere/noTilt,$2,src/advection/system/linearUpwind))
$(eval $(call SolidBodyAdvectionTest,build/solidBodySphere-noTilt-cubicUpwind-$1,build/deformationSphere-mesh-$1,src/solidBodySphere/noTilt,$2,src/advection/system/cubicUpwindCPCFit))
$(eval $(call SolidBodyAdvectionTest,build/solidBodySphere-90Tilt-linearUpwind-$1,build/deformationSphere-mesh-$1,src/solidBodySphere/90Tilt,$2,src/advection/system/linearUpwind))
$(eval $(call SolidBodyAdvectionTest,build/solidBodySphere-90Tilt-cubicUpwind-$1,build/deformationSphere-mesh-$1,src/solidBodySphere/90Tilt,$2,src/advection/system/cubicUpwindCPCFit))

endef

# $1 -- mesh type (e.g. hex)
# $2 -- error filename
# $3 -- resolutions
define SolidBodyAdvectionCollation

$(eval $(call CollateErrorsOnSphere,build/solidBodySphere-noTilt-linearUpwind-$1-,$2,$3))
$(eval $(call CollateErrorsOnSphere,build/solidBodySphere-noTilt-cubicUpwind-$1-,$2,$3))

endef

$(eval $(call SolidBodyAdvectionTestSuite,hex-5,6400))
$(eval $(call SolidBodyAdvectionTestSuite,hex-6,3200))
$(eval $(call SolidBodyAdvectionTestSuite,hex-7,1600))
$(eval $(call SolidBodyAdvectionTestSuite,hex-8,800))
$(eval $(call SolidBodyAdvectionTestSuite,tri-4,6400))
$(eval $(call SolidBodyAdvectionTestSuite,tri-5,3200))
$(eval $(call SolidBodyAdvectionTestSuite,tri-6,1600))
$(eval $(call SolidBodyAdvectionTestSuite,tri-7,800))
$(eval $(call SolidBodyAdvectionTestSuite,quad-30,1600))
$(eval $(call SolidBodyAdvectionTestSuite,quad-60,800))
$(eval $(call SolidBodyAdvectionTestSuite,quad-120,400))
$(eval $(call SolidBodyAdvectionTestSuite,quad-240,200))
$(eval $(call SolidBodyAdvectionTestSuite,latlon-36,14400))
$(eval $(call SolidBodyAdvectionTestSuite,latlon-72,7200))
$(eval $(call SolidBodyAdvectionTestSuite,latlon-144,3600))
$(eval $(call SolidBodyAdvectionTestSuite,latlon-288,1800))

$(eval $(call SolidBodyAdvectionCollation,hex,$(solidBodyAdvectionEndTime)/l2errorT.txt,5 6 7))
$(eval $(call SolidBodyAdvectionCollation,hex,$(solidBodyAdvectionEndTime)/linferrorT.txt,5 6 7))
$(eval $(call SolidBodyAdvectionCollation,tri,$(solidBodyAdvectionEndTime)/l2errorT.txt,4 5 6 7))
$(eval $(call SolidBodyAdvectionCollation,tri,$(solidBodyAdvectionEndTime)/linferrorT.txt,4 5 6 7))
$(eval $(call SolidBodyAdvectionCollation,quad,$(solidBodyAdvectionEndTime)/l2errorT.txt,30 60 120))
$(eval $(call SolidBodyAdvectionCollation,quad,$(solidBodyAdvectionEndTime)/linferrorT.txt,30 60 120))
$(eval $(call SolidBodyAdvectionCollation,latlon,$(solidBodyAdvectionEndTime)/l2errorT.txt,36 72 144 288))
$(eval $(call SolidBodyAdvectionCollation,latlon,$(solidBodyAdvectionEndTime)/linferrorT.txt,36 72 144 288))

$(eval $(call MakeDir,build/solidBodySphere-noTilt-linearUpwind-hex-collated/$(solidBodyAdvectionEndTime)/))
$(eval $(call MakeDir,build/solidBodySphere-noTilt-cubicUpwind-hex-collated/$(solidBodyAdvectionEndTime)/))
$(eval $(call MakeDir,build/solidBodySphere-noTilt-linearUpwind-tri-collated/$(solidBodyAdvectionEndTime)/))
$(eval $(call MakeDir,build/solidBodySphere-noTilt-cubicUpwind-tri-collated/$(solidBodyAdvectionEndTime)/))
$(eval $(call MakeDir,build/solidBodySphere-noTilt-linearUpwind-quad-collated/$(solidBodyAdvectionEndTime)/))
$(eval $(call MakeDir,build/solidBodySphere-noTilt-cubicUpwind-quad-collated/$(solidBodyAdvectionEndTime)/))
$(eval $(call MakeDir,build/solidBodySphere-noTilt-linearUpwind-latlon-collated/$(solidBodyAdvectionEndTime)/))
$(eval $(call MakeDir,build/solidBodySphere-noTilt-cubicUpwind-latlon-collated/$(solidBodyAdvectionEndTime)/))
